<Window x:Class="Orts.TimetableEditor.Views.TrainView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Orts.TimetableEditor.Views"
        xmlns:ViewModel="clr-namespace:Orts.TimetableEditor.ViewModel"
        xmlns:Converters="clr-namespace:Orts.TimetableEditor.Converters"
        mc:Ignorable="d"
        Title="Consist" Height="550" Width="1200" WindowStartupLocation="CenterScreen" SizeToContent="Height" ResizeMode="NoResize">
    <Window.DataContext>
        <ViewModel:TrainViewModel/>
    </Window.DataContext>
    <Window.Resources>
        <Converters:BooleanToVisibilityConverter x:Key="boolVisConverter"></Converters:BooleanToVisibilityConverter>
        <Converters:BooleanToVisibilityConverterHidden x:Key="boolVisHiddenConverters"></Converters:BooleanToVisibilityConverterHidden>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="200"/>
            <RowDefinition Height="250"/>
            <RowDefinition Height="40"/>
        </Grid.RowDefinitions>
        <Border Background="LightGreen">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.ColumnSpan="2" Text="Paths (Double-Click to choose Path)"/>
                <CheckBox Grid.Row="1" Content="normal paths" IsChecked="{Binding ShowNormalPaths}"/>
                <CheckBox Grid.Row="1" Grid.Column="1" Content="siding paths" IsChecked="{Binding ShowSidingsPaths}"/>
                <Button Grid.Row="1" Grid.Column="2" Content="s" Width="20" Height="20" Visibility="Collapsed"/>
                <ListView x:Name="PathListView" Grid.Row="2" Grid.ColumnSpan="3" ItemsSource="{Binding TrainPathsSorted}" MouseDoubleClick="PathListView_MouseDoubleClick" SelectedItem="{Binding SelectedTrainPath}" Background="LightGreen">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Filename" Width="180" DisplayMemberBinding="{Binding FileName}"/>
                            <GridViewColumn Header="Pathname" Width="190" DisplayMemberBinding="{Binding Name}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </Border>
        <!--Second Column-->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="20"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="120"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="Name"/>
            <TextBox Grid.Column="1" Text="{Binding TrainName}"/>
            <TextBlock Grid.Row="1" Text="Comment"/>
            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Comment}"/>
            <Border Grid.Row="2" Background="LightGreen">
                <TextBlock Text="Path"/>
            </Border>
            <Border Grid.Row="2" Grid.Column="1" Background="LightGreen">
                <TextBlock  Text="{Binding ChosenTrainPath, Mode=TwoWay}"/>
            </Border>
            <Border Grid.Row="3" Background="LightSteelBlue">
                <TextBlock Text="Consist"/>
            </Border>
            <Border Grid.Row="3" Grid.Column="1" Background="LightSteelBlue">
                <CheckBox Content="multi" Grid.Row="3" Grid.Column="1" IsChecked="{Binding MultiConsist}"/>
            </Border>
            <Border Grid.Row="4" Background="LightSteelBlue">
                <StackPanel  Visibility="{Binding MultiConsist, Converter={StaticResource boolVisConverter}}">
                    <Button Width="32" Height="32" ToolTip="Move up" Command="{Binding MoveConsistUp}">
                        <Image Width="24" Height="24" Source="/Images/Move_Up_24x24.png"/>
                    </Button>
                    <Button Width="32" Height="32" ToolTip="Remove" Command="{Binding RemoveConsist}">
                        <Image Width="24" Height="24" Source="/Images/Remove_24x24.png"/>
                    </Button>
                    <Button Width="32" Height="32" ToolTip="Move Down" Command="{Binding MoveConsistsDown}">
                        <Image Width="24" Height="24" Source="/Images/Move_Down_24x24.png"/>
                    </Button>
                </StackPanel>
            </Border>
            <ListView Grid.Row="4" Grid.Column="1" ItemsSource="{Binding Con}" SelectedIndex="{Binding SelectedConsistIndex}" Background="LightSteelBlue">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="reverse">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding Reversed}" Width="33"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="200"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </Grid>
        <!--Third Column-->
        <Border Grid.Column="2" Background="LightSteelBlue">
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.ColumnSpan="2" Text="Consists (Double Click to choose)"/>
                <CheckBox Grid.Row="1" Content="Engines (+Wagons)" IsChecked="{Binding ShowEngines}"/>
                <CheckBox Grid.Row="1" Grid.Column="1" Content="Wagons only" IsChecked="{Binding ShowWagons}"/>
                <Button Grid.Row="1" Grid.Column="2" Content="+" Width="20" Command="{Binding AddConsist}" Visibility="Collapsed"/>
                <ListView x:Name="Consists_ListView" Grid.Row="2" Grid.ColumnSpan="3" ItemsSource="{Binding ConsistsSorted}" SelectedItem="{Binding SelectedConsist}" MouseDoubleClick="Consists_ListView_MouseDoubleClick" Background="LightSteelBlue">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Filename" Width="180" DisplayMemberBinding="{Binding FileName}"/>
                            <GridViewColumn Header="Consistname" Width="190" DisplayMemberBinding="{Binding Name}"/>
                        </GridView>
                    </ListView.View>
                </ListView>            
            </Grid>
        </Border>
        <Grid Grid.Row="1" Grid.ColumnSpan="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <TextBlock Text="Start" VerticalAlignment="Center"/>
            <Grid Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Modus:" VerticalAlignment="Center"/>
                <RadioButton Grid.Column="1" IsChecked="{Binding ModusTime}" Content="Time" VerticalAlignment="Center"/>
                <TextBox Grid.Column="2" Text="{Binding StartTime}" Visibility="{Binding ModusTime, Converter={StaticResource boolVisConverter}}" Height="20"/>
                <RadioButton Grid.Column="3" Content="$static" IsChecked="{Binding ModusStatic}" VerticalAlignment="Center"/>
            </Grid>            
            <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Horizontal">
                <TextBlock Text="Command:" Height="20"/>
                <ComboBox ItemsSource="{Binding PossibleCommands}" SelectedItem="{Binding SelectedPossibleCommand}" Width="150" Height="22" Margin="5 0"/>
                <Button Width="32" Command="{Binding AddCommand}" ToolTip="Add Command">
                    <Image Width="24" Height="24" Source="/Images/Add_24x24.png"/>
                </Button>
                <Button Width="32" Command="{Binding RemoveCommand}" ToolTip="Remove Command">
                    <Image Width="24" Height="24" Source="/Images/Remove_24x24.png"/>
                </Button>
            </StackPanel>
            <ListView Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" ItemsSource="{Binding Commands}" SelectedItem="{Binding SelectedCommand}">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="Command" Width="100" DisplayMemberBinding="{Binding Name}"/>
                        <GridViewColumn Header="Command-Value" Width="215">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="90"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="32"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Text="{Binding Value}" Visibility="{Binding HasValue, Converter={StaticResource boolVisHiddenConverters}}"/>
                                        <ComboBox Grid.Column="1" ItemsSource="{Binding Items}" SelectedItem="{Binding SelectedItem}" Visibility="{Binding HasItems, Converter={StaticResource boolVisHiddenConverters}}" Width="80"/>
                                        <Button Grid.Column="2" Width="32" Content="Set" Visibility="{Binding HasItems, Converter={StaticResource boolVisHiddenConverters}}" Command="{Binding SetValue}"/>
                                    </Grid>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Parameter" Width="460">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Grid Visibility="{Binding CanHaveParameters, Converter={StaticResource boolVisConverter}}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="350"/>
                                            <ColumnDefinition Width="80"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="22"/>
                                            <RowDefinition Height="32"/>
                                            <RowDefinition Height="32"/>
                                        </Grid.RowDefinitions>
                                        <ListView Grid.RowSpan="3" ItemsSource="{Binding Parameters}" SelectedItem="{Binding SelectedParameter}">
                                            <ListView.View>
                                                <GridView>
                                                    <GridViewColumn Header="Parameter" DisplayMemberBinding="{Binding ParameterName}" Width="100"/>
                                                    <GridViewColumn Header="Parameter-Value" Width="215">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="90"/>
                                                                        <ColumnDefinition Width="80"/>
                                                                        <ColumnDefinition Width="32"/>
                                                                    </Grid.ColumnDefinitions>
                                                                    <TextBox Text="{Binding ParameterValue}"/>
                                                                    <ComboBox Grid.Column="1" ItemsSource="{Binding Items}" SelectedItem="{Binding SelectedItem}"/>
                                                                    <Button Grid.Column="2" Content="Set" Command="{Binding SetValue}"/>
                                                                </Grid>
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                </GridView>
                                            </ListView.View>
                                        </ListView>
                                        <ComboBox Grid.Column="1" ItemsSource="{Binding PossibleParameters}" SelectedItem="{Binding SelectedPossibleParameter}"/>
                                        <Button Grid.Row="1" Grid.Column="1" Command="{Binding AddParameter}" Width="32" ToolTip="Add Parameter">
                                            <Image Width="24" Height="24" Source="/Images/Add_24x24.png"/>
                                        </Button>
                                        <Button Grid.Row="2" Grid.Column="1" Command="{Binding RemoveParameter}" Width="32" ToolTip="Remove Parameter">
                                            <Image Width="24" Height="24" Source="/Images/Remove_24x24.png"/>
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>
        </Grid>
        <StackPanel Grid.Row="2" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Center">
            <Button Width="70" Height="23" Content="OK" Margin="50 0" x:Name="OK_Button" Click="OK_Button_Click"/>
            <Button Width="70" Height="23" Content="Cancel" IsCancel="True" Margin="50 0"/>
        </StackPanel>
    </Grid>
</Window>
